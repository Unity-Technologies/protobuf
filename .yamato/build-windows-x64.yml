windows-c-libraries:
  name: Build protobuf - Windows 10 x64 with VS 2017

  agent:
    type: Unity::VM
    image: desktop/desktop-vs2017:latest
    flavor: b1.medium

  artifacts:
    build_win:
      paths:
        - builds/**

  commands:
    - |
      cd cmake
      BuildProtobufOnYamatoWithCMake.bat
    - |
      xcopy cmake\install\bin builds\bin\win64 /s /i
      xcopy cmake\install\lib builds\lib\win64 /s /i
      xcopy cmake\install_debug\lib\*.lib builds\lib\win64 /s /i

windows-csharp-bindings:
  name: Build C# protobuf - Windows 10 x64 with VS 2017

  agent:
    type: Unity::VM
    image: desktop/desktop-vs2017:latest
    flavor: b1.medium

  artifacts:
    build_win:
      paths:
        - csharp/src/Google.Protobuf/bin/Debug/**

  commands:
    - |
      cd csharp
      powershell install_dotnet_sdk.ps1
      buildall.bat
