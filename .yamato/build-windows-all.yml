windows-c-libraries:
  name: Build protobuf - Windows 10 x64 with VS 2017

  agent:
    type: Unity::VM
    image: platform-foundation/windows-bokken:latest
    flavor: b1.medium

  artifacts:
    build_win:
      paths:
        - builds/**

  commands:
    - .\bee\bee win_x64_vs2017_win7
    - .\bee\bee win_arm64_vs2019_win7

csharp-bindings:
  name: Build C# Bindings

  agent:
    type: Unity::VM
    image: platform-foundation/windows-bokken:latest
    flavor: b1.medium

  artifacts:
    build_csharp:
      paths:
        - csharp/src/Google.Protobuf/bin/Debug/**

  commands:
    - |
      cd csharp
      powershell -File install_dotnet_sdk.ps1
      set PATH=%PATH%;C:\Users\bokken\AppData\Local\Microsoft\dotnet\
      buildall.bat